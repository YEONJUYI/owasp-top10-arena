<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>ê´€ë¦¬ì - JWTBank</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#0d1117; color:#c9d1d9; font-family:'Courier New',monospace; }

    nav {
      background:#161b22; padding:16px 32px;
      display:flex; justify-content:space-between; align-items:center;
      border-bottom:1px solid #30363d;
    }
    nav .logo { color:#f85149; font-size:1rem; font-weight:bold; }
    nav a { color:#8b949e; text-decoration:none; font-size:0.8rem; }
    nav a:hover { color:#f85149; }

    .hero { text-align:center; padding:48px 20px 32px; }
    .badge {
      display:inline-block; background:#1f2937;
      border:1px solid #ec4899; color:#ec4899;
      padding:4px 12px; border-radius:9999px;
      font-size:0.72rem; margin-bottom:16px;
    }
    .hero h1 { font-size:1.5rem; color:#f0f6fc; margin-bottom:8px; }
    .hero p { color:#8b949e; font-size:0.82rem; }

    .container { max-width:700px; margin:0 auto; padding:0 24px 60px; }

    /* ì—ëŸ¬ ë°•ìŠ¤ */
    .error-box {
      background:#2d1515; border:1px solid #f85149;
      border-radius:10px; padding:24px;
      margin-bottom:24px;
    }
    .error-box h2 { color:#f85149; font-size:1rem; margin-bottom:12px; }
    .error-box p { color:#8b949e; font-size:0.83rem; line-height:1.7; }

    /* ê³µê²© ë°©ë²• ì¹´ë“œ */
    .flow-card {
      background:#161b22; border:1px solid #30363d;
      border-radius:8px; overflow:hidden; margin-bottom:20px;
    }
    .flow-header {
      padding:14px 20px; border-bottom:1px solid #21262d;
      font-size:0.85rem; color:#f0f6fc; font-weight:bold;
    }
    .flow-body { padding:20px; }
    .flow-step {
      display:flex; align-items:flex-start; gap:14px;
      padding:10px 0; border-bottom:1px solid #21262d; font-size:0.82rem;
    }
    .flow-step:last-child { border-bottom:none; }
    .step-num {
      background:#1f2937; color:#ec4899;
      border:1px solid #9d174d; border-radius:4px;
      padding:2px 8px; font-size:0.75rem; white-space:nowrap; flex-shrink:0;
    }
    .step-text { color:#8b949e; line-height:1.6; }
    .step-text code {
      background:#010409; color:#f9a8d4;
      padding:1px 6px; border-radius:4px; font-size:0.78rem;
      word-break:break-all;
    }
    .step-text b { color:#f0f6fc; }

    /* ì·¨ì•½ì /ëŒ€ì‘ë°©ì•ˆ */
    .info-card {
      background:#161b22; border:1px solid #30363d;
      border-radius:8px; overflow:hidden;
    }
    .info-header {
      padding:14px 20px; border-bottom:1px solid #21262d;
      font-size:0.85rem; color:#f0f6fc; font-weight:bold;
    }
    .info-row {
      display:flex; align-items:flex-start; gap:12px;
      padding:12px 20px; border-bottom:1px solid #21262d; font-size:0.82rem;
    }
    .info-row:last-child { border-bottom:none; }
    .tag-vuln {
      background:#2d1515; color:#f85149;
      border:1px solid #f8514933; border-radius:4px;
      padding:2px 8px; font-size:0.72rem; white-space:nowrap; flex-shrink:0;
    }
    .tag-fix {
      background:#0f2a1a; color:#3fb950;
      border:1px solid #23863633; border-radius:4px;
      padding:2px 8px; font-size:0.72rem; white-space:nowrap; flex-shrink:0;
    }
    .info-text { color:#8b949e; line-height:1.6; }
    .info-text code {
      background:#0d1117; color:#79c0ff;
      padding:1px 5px; border-radius:3px; font-size:0.78rem;
    }
  </style>
</head>
<body>

<nav>
  <span class="logo">âš ï¸ ê´€ë¦¬ì í˜ì´ì§€</span>
  <a href="/">â† í™ˆ</a>
</nav>

<div class="hero">
  <div class="badge">A07 Â· Authentication Failures</div>
  <h1>ì ‘ê·¼ ê±°ë¶€</h1>
  <p>ë¸Œë¼ìš°ì € ì§ì ‘ ì ‘ê·¼ì€ í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
</div>

<div class="container">

  <div class="error-box">
    <h2>ğŸš« {{ error }}</h2>
    <p>
      ì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” <b>curl</b> ë˜ëŠ” <b>Burp Suite</b> ë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>
      <code>Authorization: Bearer &lt;ë³€ì¡°ëœ_JWT&gt;</code> í—¤ë”ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.
    </p>
  </div>

  <!-- ê³µê²© íë¦„ -->
  <div class="flow-card">
    <div class="flow-header">ğŸ”§ ê³µê²© ë°©ë²• (JWT alg:none)</div>
    <div class="flow-body">
      <div class="flow-step">
        <span class="step-num">STEP 1</span>
        <div class="step-text">
          <b>JWT í† í° íšë“</b><br>
          <code>user1 / password123</code> ë¡œê·¸ì¸ â†’ ëŒ€ì‹œë³´ë“œ ì¿ í‚¤ì—ì„œ í† í° í™•ì¸
        </div>
      </div>
      <div class="flow-step">
        <span class="step-num">STEP 2</span>
        <div class="step-text">
          <b>Header ë³€ì¡°</b><br>
          <code>{"alg":"HS256","typ":"JWT"}</code> â†’ <code>{"alg":"none","typ":"JWT"}</code><br>
          Base64URL ì¸ì½”ë”©: <code>eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0</code>
        </div>
      </div>
      <div class="flow-step">
        <span class="step-num">STEP 3</span>
        <div class="step-text">
          <b>Payload ë³€ì¡°</b><br>
          <code>{"user":"user1","role":"user"}</code> â†’ <code>{"user":"admin","role":"admin"}</code><br>
          Base64URL ì¸ì½”ë”© í›„ êµì²´
        </div>
      </div>
      <div class="flow-step">
        <span class="step-num">STEP 4</span>
        <div class="step-text">
          <b>ì„œëª… ì œê±° í›„ curl ìš”ì²­</b><br>
          <code>curl -X GET http://localhost:5006/admin \</code><br>
          <code>&nbsp;&nbsp;-H "Authorization: Bearer &lt;header&gt;.&lt;payload&gt;."</code><br>
          ì„œëª… ë¶€ë¶„ì€ ë¹ˆ ë¬¸ìì—´ (ë§ˆì§€ë§‰ <code>.</code> ë’¤ì— ì•„ë¬´ê²ƒë„ ì—†ìŒ)
        </div>
      </div>
    </div>
  </div>

  <!-- ì·¨ì•½ì /ëŒ€ì‘ë°©ì•ˆ -->
  <div class="info-card">
    <div class="info-header">ğŸ“‹ ì·¨ì•½ì  ë¶„ì„ ë° ëŒ€ì‘ë°©ì•ˆ</div>
    <div class="info-row">
      <span class="tag-vuln">ì·¨ì•½ì </span>
      <div class="info-text"><code>alg:none</code> í—ˆìš© ì‹œ ì„œëª… ê²€ì¦ì„ ì™„ì „íˆ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    </div>
    <div class="info-row">
      <span class="tag-vuln">ì·¨ì•½ì </span>
      <div class="info-text">ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ê°€ ì œê³µí•œ <code>alg</code> ê°’ì„ ê·¸ëŒ€ë¡œ ì‹ ë¢°í•©ë‹ˆë‹¤.</div>
    </div>
    <div class="info-row">
      <span class="tag-vuln">ì·¨ì•½ì </span>
      <div class="info-text">ì„œëª… ê²€ì¦ ì—†ì´ <code>payload</code>ì˜ <code>role</code> ì„ ê·¸ëŒ€ë¡œ ì‹ ë¢°í•©ë‹ˆë‹¤.</div>
    </div>
    <div class="info-row">
      <span class="tag-fix">ëŒ€ì‘ë°©ì•ˆ</span>
      <div class="info-text">í—ˆìš©í•  ì•Œê³ ë¦¬ì¦˜ì„ ì„œë²„ ì¸¡ì—ì„œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¡œ ê³ ì •í•˜ê³  <code>none</code> ì„ ë°˜ë“œì‹œ ì°¨ë‹¨í•˜ì„¸ìš”.</div>
    </div>
    <div class="info-row">
      <span class="tag-fix">ëŒ€ì‘ë°©ì•ˆ</span>
      <div class="info-text"><code>PyJWT</code>, <code>python-jose</code> ë“± ê²€ì¦ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ ì„œëª…ì„ ë°˜ë“œì‹œ ê²€ì¦í•˜ì„¸ìš”.</div>
    </div>
    <div class="info-row">
      <span class="tag-fix">ëŒ€ì‘ë°©ì•ˆ</span>
      <div class="info-text">ë¯¼ê°í•œ ê¶Œí•œ ì •ë³´(<code>role</code>)ëŠ” í† í° payloadê°€ ì•„ë‹Œ ì„œë²„ DBì—ì„œ ì¡°íšŒí•˜ì„¸ìš”.</div>
    </div>
  </div>

</div>

</body>
</html>