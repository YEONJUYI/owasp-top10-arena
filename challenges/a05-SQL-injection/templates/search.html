<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>ê²€ìƒ‰ ê²°ê³¼ - HackShop</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#0d1117; color:#c9d1d9; font-family:'Courier New',monospace; }

    nav {
      background:#161b22; padding:16px 32px;
      display:flex; justify-content:space-between; align-items:center;
      border-bottom:1px solid #30363d;
    }
    nav .logo { color:#ef4444; font-size:1.2rem; font-weight:bold; }
    nav .nav-links a {
      color:#8b949e; text-decoration:none;
      margin-left:24px; font-size:0.85rem;
    }
    nav .nav-links a:hover { color:#ef4444; }

    .container { max-width:760px; margin:40px auto; padding:0 24px 60px; }

    /* ê²€ìƒ‰ë°” */
    .search-wrap { display:flex; gap:8px; margin-bottom:28px; }
    .search-wrap input {
      flex:1; padding:10px 16px;
      background:#161b22; border:1px solid #30363d;
      border-radius:6px; color:#f0f6fc;
      font-family:'Courier New',monospace; font-size:0.88rem; outline:none;
    }
    .search-wrap input:focus { border-color:#ef4444; }
    .search-wrap button {
      padding:10px 20px; background:#dc2626;
      border:none; border-radius:6px; color:#f0f6fc;
      font-family:'Courier New',monospace; font-weight:bold;
      font-size:0.88rem; cursor:pointer; transition:background 0.2s;
    }
    .search-wrap button:hover { background:#ef4444; }

    .result-count { color:#8b949e; font-size:0.83rem; margin-bottom:20px; }
    .result-count span { color:#ef4444; }

    /* ìƒí’ˆ ì¹´ë“œ */
    .product-card {
      background:#161b22; border:1px solid #30363d;
      border-radius:8px; padding:18px 20px;
      display:flex; align-items:center; gap:18px;
      margin-bottom:12px;
    }
    .product-card .icon { font-size:1.8rem; flex-shrink:0; }
    .product-card h3 { color:#f0f6fc; font-size:0.9rem; margin-bottom:4px; }
    .product-card .price { color:#ef4444; font-size:0.85rem; margin-bottom:4px; }
    .product-card .desc { color:#8b949e; font-size:0.78rem; line-height:1.5; }

    /* í”Œë˜ê·¸ ê°ì§€ ì¹´ë“œ */
    .flag-card {
      background:#0f2a1a; border:1px solid #238636;
      border-radius:8px; padding:18px 20px;
      display:flex; align-items:center; gap:18px;
      margin-bottom:12px;
    }
    .flag-card h3 { color:#3fb950; font-size:0.9rem; margin-bottom:4px; }
    .flag-card .price { color:#8b949e; font-size:0.85rem; margin-bottom:4px; }
    .flag-card .desc { color:#3fb950; font-size:0.9rem; font-weight:bold; word-break:break-all; }

    .no-result {
      text-align:center; padding:60px 20px;
      color:#8b949e; font-size:0.88rem;
    }

    /* íŒíŠ¸ ë°•ìŠ¤ */
    .hint-box {
      background:#1a0505; border:1px solid #dc2626;
      border-radius:8px; padding:16px 20px;
      font-size:0.8rem; color:#fca5a5; line-height:1.9;
      margin-top:20px;
    }
    .hint-box b { color:#fca5a5; }
    .hint-box code {
      background:#0d1117; color:#fca5a5;
      padding:1px 6px; border-radius:4px; font-size:0.78rem;
    }

    /* í”Œë˜ê·¸ ì œì¶œ */
    .flag-submit {
      background:#161b22; border:1px solid #30363d;
      border-radius:8px; overflow:hidden; margin-top:20px;
    }
    .flag-submit-header {
      padding:13px 20px; border-bottom:1px solid #21262d;
      font-size:0.85rem; color:#f0f6fc; font-weight:bold;
    }
    .flag-submit-body { padding:18px 20px; }
    .flag-input-wrap { display:flex; gap:10px; }
    .flag-input-wrap input {
      flex:1; background:#0d1117; border:1px solid #30363d;
      border-radius:6px; padding:9px 14px; color:#f0f6fc;
      font-family:'Courier New',monospace; font-size:0.85rem;
    }
    .flag-input-wrap input:focus { outline:none; border-color:#3fb950; }
    .btn-submit {
      background:#0f2a1a; color:#3fb950; border:1px solid #238636;
      border-radius:6px; padding:9px 18px;
      font-family:'Courier New',monospace; font-size:0.83rem; cursor:pointer;
      white-space:nowrap; transition:background 0.2s;
    }
    .btn-submit:hover { background:#1a3d28; }
    .flag-result { margin-top:12px; font-size:0.83rem; }
    .flag-correct {
      background:#0f2a1a; border:1px solid #238636;
      border-radius:6px; padding:12px 16px; color:#3fb950;
    }
    .flag-wrong {
      background:#2d1515; border:1px solid #f85149;
      border-radius:6px; padding:12px 16px; color:#f85149;
    }
  </style>
</head>
<body>

<nav>
  <span class="logo">ğŸ›ï¸ HackShop</span>
  <div class="nav-links">
    <a href="/">í™ˆ</a>
    <a href="/search">ê²€ìƒ‰</a>
  </div>
</nav>

<div class="container">

  <form action="/search" method="GET">
    <div class="search-wrap">
      <input type="text" name="q" value="{{ q }}" placeholder="ìƒí’ˆ ê²€ìƒ‰..."/>
      <button type="submit">ê²€ìƒ‰ ğŸ”</button>
    </div>
  </form>

  {% if results %}
    <div class="result-count"><span>{{ results|length }}</span>ê°œì˜ ê²€ìƒ‰ ê²°ê³¼</div>
    {% set icons = ['ğŸ’»', 'ğŸ–±ï¸', 'âŒ¨ï¸', 'ğŸ–¥ï¸', 'ğŸ“·'] %}
    {% for p in results %}
      {# í”Œë˜ê·¸ê°€ í¬í•¨ëœ ê²°ê³¼ ê°•ì¡° #}
      {% if p[1] and 'OWASP{' in p[1]|string or p[3] and 'OWASP{' in p[3]|string %}
      <div class="flag-card">
        <div style="font-size:1.8rem; flex-shrink:0;">ğŸš©</div>
        <div>
          <h3>SECRET DATA LEAKED</h3>
          <div class="price">key: {{ p[1] }}</div>
          <div class="desc">{{ p[3] }}</div>
        </div>
      </div>
      {% else %}
      <div class="product-card">
        <div class="icon">{{ icons[loop.index0 % icons|length] }}</div>
        <div>
          <h3>{{ p[1] }}</h3>
          {# UNIONìœ¼ë¡œ ë¬¸ìì—´ì´ ë“¤ì–´ì™€ë„ ì—ëŸ¬ ì•ˆ ë‚˜ê²Œ ì²˜ë¦¬ #}
          <div class="price">
            {% if p[2] is number %}â‚©{{ "{:,}".format(p[2]) }}
            {% else %}{{ p[2] }}{% endif %}
          </div>
          <div class="desc">{{ p[3] }}</div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  {% else %}
    <div class="no-result">ğŸ” ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
  {% endif %}

  <!-- íŒíŠ¸ -->
  <div class="hint-box">
    ğŸ’¡ <b>íŒíŠ¸:</b> ê²€ìƒ‰ ì¿¼ë¦¬ êµ¬ì¡°ëŠ” <code>SELECT * FROM products WHERE name LIKE '%ì…ë ¥ê°’%'</code> ì´ë‹¤.<br>
    <b>UNION SELECT</b>ë¡œ ì»¬ëŸ¼ ìˆ˜ë¥¼ ë§ì¶° <code>secrets</code> í…Œì´ë¸”ì„ ì¡°íšŒí•´ë³´ì.<br>
    ì˜ˆì‹œ: <code>' UNION SELECT 1,key,0,value FROM secrets--</code>
  </div>

  <!-- í”Œë˜ê·¸ ì œì¶œ -->
  <div class="flag-submit">
    <div class="flag-submit-header">ğŸš© Flag Submit</div>
    <div class="flag-submit-body">
      <div class="flag-input-wrap">
        <input type="text" id="flag-input" placeholder="OWASP{...}">
        <button class="btn-submit" onclick="submitFlag()">SUBMIT</button>
      </div>
      <div id="flag-result" class="flag-result"></div>
    </div>
  </div>

</div>

<script>
  function submitFlag() {
    const input  = document.getElementById('flag-input').value.trim();
    const result = document.getElementById('flag-result');
    if (input === 'OWASP{sql_1nj3ct10n_byp4ss_succ3ss}') {
      result.innerHTML = `
        <div class="flag-correct">
          âœ… <b>Correct!</b> Challenge Cleared!<br>
          <span style="font-size:0.78rem; margin-top:4px; display:block; color:#8b949e;">
            UNION SELECTë¡œ secrets í…Œì´ë¸”ì„ ì¡°íšŒí•´ í”Œë˜ê·¸ë¥¼ íƒˆì·¨í–ˆë‹¤.
          </span>
        </div>`;
    } else {
      result.innerHTML = `<div class="flag-wrong">âŒ Wrong flag. Keep trying!</div>`;
    }
  }
</script>

</body>
</html>